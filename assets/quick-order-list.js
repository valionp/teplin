/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => {
  // webpackBootstrap
  /******/ var __webpack_modules__ = {
    /***/ "./src/js/components/quick-order-list.js":
      /*!***********************************************!*\
  !*** ./src/js/components/quick-order-list.js ***!
  \***********************************************/
      /***/ () => {
        eval(
          "class QuickOrderListRemoveButton extends HTMLElement {\n  constructor() {\n    super();\n    this.addEventListener('click', (event) => {\n      event.preventDefault();\n      const quickOrderList = this.closest('quick-order-list');\n      quickOrderList.updateQuantity(this.dataset.index, 0);\n    });\n  }\n}\n\ncustomElements.define('quick-order-list-remove-button', QuickOrderListRemoveButton);\n\nclass QuickOrderListRemoveAllButton extends HTMLElement {\n  constructor() {\n    super();\n    const allVariants = Array.from(document.querySelectorAll('[data-variant-id]'));\n    const items = {};\n    let hasVariantsInCart = false;\n    this.quickOrderList = this.closest('quick-order-list');\n\n    allVariants.forEach((variant) => {\n      const cartQty = parseInt(variant.dataset.cartQty);\n      if (cartQty > 0) {\n        hasVariantsInCart = true;\n        items[parseInt(variant.dataset.variantId)] = 0;\n      }\n    });\n\n    if (!hasVariantsInCart) {\n      this.classList.add('hidden');\n    }\n\n    this.actions = {\n      confirm: 'confirm',\n      remove: 'remove',\n      cancel: 'cancel',\n    };\n\n    this.addEventListener('click', (event) => {\n      event.preventDefault();\n      if (this.dataset.action === this.actions.confirm) {\n        this.toggleConfirmation(false, true);\n      } else if (this.dataset.action === this.actions.remove) {\n        this.quickOrderList.updateMultipleQty(items);\n        this.toggleConfirmation(true, false);\n      } else if (this.dataset.action === this.actions.cancel) {\n        this.toggleConfirmation(true, false);\n      }\n    });\n  }\n\n  toggleConfirmation(showConfirmation, showInfo) {\n    this.quickOrderList\n      .querySelector('.quick-order-list-total__confirmation')\n      .classList.toggle('hidden', showConfirmation);\n    this.quickOrderList.querySelector('.quick-order-list-total__info').classList.toggle('hidden', showInfo);\n  }\n}\n\ncustomElements.define('quick-order-list-remove-all-button', QuickOrderListRemoveAllButton);\n\nclass QuickOrderList extends HTMLElement {\n  constructor() {\n    super();\n    this.cart = document.querySelector('cart-drawer');\n    this.actions = {\n      add: 'ADD',\n      update: 'UPDATE',\n    };\n    this.quickOrderListId = 'quick-order-list';\n    this.variantItemStatusElement = document.getElementById('shopping-cart-variant-item-status');\n    const form = this.querySelector('form');\n\n    form.addEventListener('submit', this.onSubmit.bind(this));\n\n    const debouncedOnChange = debounce((event) => {\n      this.onChange(event);\n    }, ON_CHANGE_DEBOUNCE_TIMER);\n    this.addEventListener('change', debouncedOnChange.bind(this));\n  }\n\n  cartUpdateUnsubscriber = undefined;\n\n  onSubmit(event) {\n    event.preventDefault();\n  }\n\n  connectedCallback() {\n    this.cartUpdateUnsubscriber = subscribe(PUB_SUB_EVENTS.cartUpdate, (event) => {\n      if (event.source === this.quickOrderListId) {\n        return;\n      }\n      // If its another section that made the update\n      this.onCartUpdate();\n    });\n    this.sectionId = this.dataset.id;\n  }\n\n  disconnectedCallback() {\n    if (this.cartUpdateUnsubscriber) {\n      this.cartUpdateUnsubscriber();\n    }\n  }\n\n  onChange(event) {\n    const inputValue = parseInt(event.target.value);\n    const cartQuantity = parseInt(event.target.dataset.cartQuantity);\n    const index = event.target.dataset.index;\n    const name = document.activeElement.getAttribute('name');\n\n    const quantity = inputValue - cartQuantity;\n\n    if (cartQuantity > 0) {\n      this.updateQuantity(index, inputValue, name, this.actions.update);\n    } else {\n      this.updateQuantity(index, quantity, name, this.actions.add);\n    }\n  }\n\n  onCartUpdate() {\n    fetch(`${window.location.pathname}?section_id=${this.sectionId}`)\n      .then((response) => response.text())\n      .then((responseText) => {\n        const html = new DOMParser().parseFromString(responseText, 'text/html');\n        const sourceQty = html.querySelector(this.quickOrderListId);\n        this.innerHTML = sourceQty.innerHTML;\n      })\n      .catch((e) => {\n        console.error(e);\n      });\n  }\n\n  getSectionsToRender() {\n    return [\n      {\n        id: this.quickOrderListId,\n        section: document.getElementById(this.quickOrderListId).dataset.id,\n        selector: '.js-contents',\n      },\n      {\n        id: 'cart-icon-bubble',\n        section: 'cart-icon-bubble',\n        selector: '.shopify-section',\n      },\n      {\n        id: 'quick-order-list-live-region-text',\n        section: 'cart-live-region-text',\n        selector: '.shopify-section',\n      },\n      {\n        id: 'quick-order-list-total',\n        section: document.getElementById(this.quickOrderListId).dataset.id,\n        selector: '.quick-order-list__total',\n      },\n      {\n        id: 'CartDrawer',\n        selector: '#CartDrawer',\n        section: 'cart-drawer',\n      },\n    ];\n  }\n\n  renderSections(parsedState) {\n    this.getSectionsToRender().forEach((section) => {\n      const sectionElement = document.getElementById(section.id);\n      if (sectionElement && sectionElement.parentElement && sectionElement.parentElement.classList.contains('drawer')) {\n        parsedState.items.length > 0\n          ? sectionElement.parentElement.classList.remove('is-empty')\n          : sectionElement.parentElement.classList.add('is-empty');\n\n        setTimeout(() => {\n          document.querySelector('#CartDrawer-Overlay').addEventListener('click', this.cart.close.bind(this.cart));\n        });\n      }\n      const elementToReplace =\n        sectionElement && sectionElement.querySelector(section.selector)\n          ? sectionElement.querySelector(section.selector)\n          : sectionElement;\n      if (elementToReplace) {\n        elementToReplace.innerHTML = this.getSectionInnerHTML(parsedState.sections[section.section], section.selector);\n      }\n    });\n  }\n\n  updateMultipleQty(items) {\n    this.querySelector('.variant-remove-total .loading__spinner').classList.remove('hidden');\n\n    const body = JSON.stringify({\n      updates: items,\n      sections: this.getSectionsToRender().map((section) => section.section),\n      sections_url: window.location.pathname,\n    });\n\n    this.updateMessage();\n    this.setErrorMessage();\n\n    fetch(`${routes.cart_update_url}`, { ...fetchConfig(), ...{ body } })\n      .then((response) => {\n        return response.text();\n      })\n      .then((state) => {\n        const parsedState = JSON.parse(state);\n        this.renderSections(parsedState);\n      })\n      .catch(() => {\n        this.setErrorMessage(window.cartStrings.error);\n      })\n      .finally(() => {\n        this.querySelector('.variant-remove-total .loading__spinner').classList.add('hidden');\n      });\n  }\n\n  updateQuantity(id, quantity, name, action) {\n    this.toggleLoading(id, true);\n\n    let routeUrl = routes.cart_change_url;\n    let body = JSON.stringify({\n      quantity,\n      id,\n      sections: this.getSectionsToRender().map((section) => section.section),\n      sections_url: window.location.pathname,\n    });\n    let fetchConfigType;\n    if (action === this.actions.add) {\n      fetchConfigType = 'javascript';\n      routeUrl = routes.cart_add_url;\n      body = JSON.stringify({\n        items: [\n          {\n            quantity: parseInt(quantity),\n            id: parseInt(id),\n          },\n        ],\n        sections: this.getSectionsToRender().map((section) => section.section),\n        sections_url: window.location.pathname,\n      });\n    }\n\n    this.updateMessage();\n    this.setErrorMessage();\n\n    fetch(`${routeUrl}`, { ...fetchConfig(fetchConfigType), ...{ body } })\n      .then((response) => {\n        return response.text();\n      })\n      .then((state) => {\n        const parsedState = JSON.parse(state);\n        const quantityElement = document.getElementById(`Quantity-${id}`);\n        const items = document.querySelectorAll('.variant-item');\n\n        if (parsedState.description || parsedState.errors) {\n          const variantItem = document.querySelector(\n            `[id^=\"Variant-${id}\"] .variant-item__totals.small-hide .loading__spinner`\n          );\n          variantItem.classList.add('loading__spinner--error');\n          this.resetQuantityInput(id, quantityElement);\n          if (parsedState.errors) {\n            this.updateLiveRegions(id, parsedState.errors);\n          } else {\n            this.updateLiveRegions(id, parsedState.description);\n          }\n          return;\n        }\n\n        this.classList.toggle('is-empty', parsedState.item_count === 0);\n\n        this.renderSections(parsedState);\n\n        let hasError = false;\n\n        const currentItem = parsedState.items.find((item) => item.variant_id === parseInt(id));\n        const updatedValue = currentItem ? currentItem.quantity : undefined;\n        if (updatedValue && updatedValue !== quantity) {\n          this.updateError(updatedValue, id);\n          hasError = true;\n        }\n\n        const variantItem = document.getElementById(`Variant-${id}`);\n        if (variantItem && variantItem.querySelector(`[name=\"${name}\"]`)) {\n          variantItem.querySelector(`[name=\"${name}\"]`).focus();\n        }\n        publish(PUB_SUB_EVENTS.cartUpdate, { source: this.quickOrderListId, cartData: parsedState });\n\n        if (hasError) {\n          this.updateMessage();\n        } else if (action === this.actions.add) {\n          this.updateMessage(parseInt(quantity));\n        } else if (action === this.actions.update) {\n          this.updateMessage(parseInt(quantity - quantityElement.dataset.cartQuantity));\n        } else {\n          this.updateMessage(-parseInt(quantityElement.dataset.cartQuantity));\n        }\n      })\n      .catch((error) => {\n        this.querySelectorAll('.loading__spinner').forEach((overlay) => overlay.classList.add('hidden'));\n        this.resetQuantityInput(id);\n        console.error(error);\n        this.setErrorMessage(window.cartStrings.error);\n      })\n      .finally(() => {\n        this.toggleLoading(id);\n      });\n  }\n\n  resetQuantityInput(id, quantityElement) {\n    const input = quantityElement ?? document.getElementById(`Quantity-${id}`);\n    input.value = input.getAttribute('value');\n  }\n\n  setErrorMessage(message = null) {\n    this.errorMessageTemplate =\n      this.errorMessageTemplate ??\n      document.getElementById(`QuickOrderListErrorTemplate-${this.sectionId}`).cloneNode(true);\n    const errorElements = document.querySelectorAll('.quick-order-list-error');\n\n    errorElements.forEach((errorElement) => {\n      errorElement.innerHTML = '';\n      if (!message) return;\n      const updatedMessageElement = this.errorMessageTemplate.cloneNode(true);\n      updatedMessageElement.content.querySelector('.quick-order-list-error-message').innerText = message;\n      errorElement.appendChild(updatedMessageElement.content);\n    });\n  }\n\n  updateMessage(quantity = null) {\n    const messages = this.querySelectorAll('.quick-order-list__message-text');\n    const icons = this.querySelectorAll('.quick-order-list__message-icon');\n\n    if (quantity === null || isNaN(quantity)) {\n      messages.forEach((message) => (message.innerHTML = ''));\n      icons.forEach((icon) => icon.classList.add('hidden'));\n      return;\n    }\n\n    const isQuantityNegative = quantity < 0;\n    const absQuantity = Math.abs(quantity);\n\n    const textTemplate = isQuantityNegative\n      ? absQuantity === 1\n        ? window.quickOrderListStrings.itemRemoved\n        : window.quickOrderListStrings.itemsRemoved\n      : quantity === 1\n      ? window.quickOrderListStrings.itemAdded\n      : window.quickOrderListStrings.itemsAdded;\n\n    messages.forEach((msg) => (msg.innerHTML = textTemplate.replace('[quantity]', absQuantity)));\n\n    if (!isQuantityNegative) {\n      icons.forEach((i) => i.classList.remove('hidden'));\n    }\n  }\n\n  updateError(updatedValue, id) {\n    let message = '';\n    if (typeof updatedValue === 'undefined') {\n      message = window.cartStrings.error;\n    } else {\n      message = window.cartStrings.quantityError.replace('[quantity]', updatedValue);\n    }\n    this.updateLiveRegions(id, message);\n  }\n\n  updateLiveRegions(id, message) {\n    const variantItemErrorDesktop = document.getElementById(`Quick-order-list-item-error-desktop-${id}`);\n    const variantItemErrorMobile = document.getElementById(`Quick-order-list-item-error-mobile-${id}`);\n    if (variantItemErrorDesktop) {\n      variantItemErrorDesktop.querySelector('.variant-item__error-text').innerHTML = message;\n      variantItemErrorDesktop.closest('tr').classList.remove('hidden');\n    }\n    if (variantItemErrorMobile) variantItemErrorMobile.querySelector('.variant-item__error-text').innerHTML = message;\n\n    this.variantItemStatusElement.setAttribute('aria-hidden', true);\n\n    const cartStatus = document.getElementById('quick-order-list-live-region-text');\n    cartStatus.setAttribute('aria-hidden', false);\n\n    setTimeout(() => {\n      cartStatus.setAttribute('aria-hidden', true);\n    }, 1000);\n  }\n\n  getSectionInnerHTML(html, selector) {\n    return new DOMParser().parseFromString(html, 'text/html').querySelector(selector).innerHTML;\n  }\n\n  toggleLoading(id, enable) {\n    const quickOrderList = document.getElementById(this.quickOrderListId);\n    const quickOrderListItems = this.querySelectorAll(`#Variant-${id} .loading__spinner`);\n\n    if (enable) {\n      quickOrderList.classList.add('quick-order-list__container--disabled');\n      [...quickOrderListItems].forEach((overlay) => overlay.classList.remove('hidden'));\n      document.activeElement.blur();\n      this.variantItemStatusElement.setAttribute('aria-hidden', false);\n    } else {\n      quickOrderList.classList.remove('quick-order-list__container--disabled');\n      quickOrderListItems.forEach((overlay) => overlay.classList.add('hidden'));\n    }\n  }\n}\n\ncustomElements.define('quick-order-list', QuickOrderList);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvanMvY29tcG9uZW50cy9xdWljay1vcmRlci1saXN0LmpzLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVhcm4td2VicGFjay8uL3NyYy9qcy9jb21wb25lbnRzL3F1aWNrLW9yZGVyLWxpc3QuanM/YzQ2MiJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBRdWlja09yZGVyTGlzdFJlbW92ZUJ1dHRvbiBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY29uc3QgcXVpY2tPcmRlckxpc3QgPSB0aGlzLmNsb3Nlc3QoJ3F1aWNrLW9yZGVyLWxpc3QnKTtcbiAgICAgIHF1aWNrT3JkZXJMaXN0LnVwZGF0ZVF1YW50aXR5KHRoaXMuZGF0YXNldC5pbmRleCwgMCk7XG4gICAgfSk7XG4gIH1cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdxdWljay1vcmRlci1saXN0LXJlbW92ZS1idXR0b24nLCBRdWlja09yZGVyTGlzdFJlbW92ZUJ1dHRvbik7XG5cbmNsYXNzIFF1aWNrT3JkZXJMaXN0UmVtb3ZlQWxsQnV0dG9uIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIGNvbnN0IGFsbFZhcmlhbnRzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS12YXJpYW50LWlkXScpKTtcbiAgICBjb25zdCBpdGVtcyA9IHt9O1xuICAgIGxldCBoYXNWYXJpYW50c0luQ2FydCA9IGZhbHNlO1xuICAgIHRoaXMucXVpY2tPcmRlckxpc3QgPSB0aGlzLmNsb3Nlc3QoJ3F1aWNrLW9yZGVyLWxpc3QnKTtcblxuICAgIGFsbFZhcmlhbnRzLmZvckVhY2goKHZhcmlhbnQpID0+IHtcbiAgICAgIGNvbnN0IGNhcnRRdHkgPSBwYXJzZUludCh2YXJpYW50LmRhdGFzZXQuY2FydFF0eSk7XG4gICAgICBpZiAoY2FydFF0eSA+IDApIHtcbiAgICAgICAgaGFzVmFyaWFudHNJbkNhcnQgPSB0cnVlO1xuICAgICAgICBpdGVtc1twYXJzZUludCh2YXJpYW50LmRhdGFzZXQudmFyaWFudElkKV0gPSAwO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFoYXNWYXJpYW50c0luQ2FydCkge1xuICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmFjdGlvbnMgPSB7XG4gICAgICBjb25maXJtOiAnY29uZmlybScsXG4gICAgICByZW1vdmU6ICdyZW1vdmUnLFxuICAgICAgY2FuY2VsOiAnY2FuY2VsJyxcbiAgICB9O1xuXG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmICh0aGlzLmRhdGFzZXQuYWN0aW9uID09PSB0aGlzLmFjdGlvbnMuY29uZmlybSkge1xuICAgICAgICB0aGlzLnRvZ2dsZUNvbmZpcm1hdGlvbihmYWxzZSwgdHJ1ZSk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YXNldC5hY3Rpb24gPT09IHRoaXMuYWN0aW9ucy5yZW1vdmUpIHtcbiAgICAgICAgdGhpcy5xdWlja09yZGVyTGlzdC51cGRhdGVNdWx0aXBsZVF0eShpdGVtcyk7XG4gICAgICAgIHRoaXMudG9nZ2xlQ29uZmlybWF0aW9uKHRydWUsIGZhbHNlKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXRhc2V0LmFjdGlvbiA9PT0gdGhpcy5hY3Rpb25zLmNhbmNlbCkge1xuICAgICAgICB0aGlzLnRvZ2dsZUNvbmZpcm1hdGlvbih0cnVlLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVDb25maXJtYXRpb24oc2hvd0NvbmZpcm1hdGlvbiwgc2hvd0luZm8pIHtcbiAgICB0aGlzLnF1aWNrT3JkZXJMaXN0XG4gICAgICAucXVlcnlTZWxlY3RvcignLnF1aWNrLW9yZGVyLWxpc3QtdG90YWxfX2NvbmZpcm1hdGlvbicpXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJywgc2hvd0NvbmZpcm1hdGlvbik7XG4gICAgdGhpcy5xdWlja09yZGVyTGlzdC5xdWVyeVNlbGVjdG9yKCcucXVpY2stb3JkZXItbGlzdC10b3RhbF9faW5mbycpLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicsIHNob3dJbmZvKTtcbiAgfVxufVxuXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ3F1aWNrLW9yZGVyLWxpc3QtcmVtb3ZlLWFsbC1idXR0b24nLCBRdWlja09yZGVyTGlzdFJlbW92ZUFsbEJ1dHRvbik7XG5cbmNsYXNzIFF1aWNrT3JkZXJMaXN0IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuY2FydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2NhcnQtZHJhd2VyJyk7XG4gICAgdGhpcy5hY3Rpb25zID0ge1xuICAgICAgYWRkOiAnQUREJyxcbiAgICAgIHVwZGF0ZTogJ1VQREFURScsXG4gICAgfTtcbiAgICB0aGlzLnF1aWNrT3JkZXJMaXN0SWQgPSAncXVpY2stb3JkZXItbGlzdCc7XG4gICAgdGhpcy52YXJpYW50SXRlbVN0YXR1c0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcHBpbmctY2FydC12YXJpYW50LWl0ZW0tc3RhdHVzJyk7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMucXVlcnlTZWxlY3RvcignZm9ybScpO1xuXG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLm9uU3VibWl0LmJpbmQodGhpcykpO1xuXG4gICAgY29uc3QgZGVib3VuY2VkT25DaGFuZ2UgPSBkZWJvdW5jZSgoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMub25DaGFuZ2UoZXZlbnQpO1xuICAgIH0sIE9OX0NIQU5HRV9ERUJPVU5DRV9USU1FUik7XG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBkZWJvdW5jZWRPbkNoYW5nZS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIGNhcnRVcGRhdGVVbnN1YnNjcmliZXIgPSB1bmRlZmluZWQ7XG5cbiAgb25TdWJtaXQoZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG5cbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgdGhpcy5jYXJ0VXBkYXRlVW5zdWJzY3JpYmVyID0gc3Vic2NyaWJlKFBVQl9TVUJfRVZFTlRTLmNhcnRVcGRhdGUsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gdGhpcy5xdWlja09yZGVyTGlzdElkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIC8vIElmIGl0cyBhbm90aGVyIHNlY3Rpb24gdGhhdCBtYWRlIHRoZSB1cGRhdGVcbiAgICAgIHRoaXMub25DYXJ0VXBkYXRlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5zZWN0aW9uSWQgPSB0aGlzLmRhdGFzZXQuaWQ7XG4gIH1cblxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICBpZiAodGhpcy5jYXJ0VXBkYXRlVW5zdWJzY3JpYmVyKSB7XG4gICAgICB0aGlzLmNhcnRVcGRhdGVVbnN1YnNjcmliZXIoKTtcbiAgICB9XG4gIH1cblxuICBvbkNoYW5nZShldmVudCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWUgPSBwYXJzZUludChldmVudC50YXJnZXQudmFsdWUpO1xuICAgIGNvbnN0IGNhcnRRdWFudGl0eSA9IHBhcnNlSW50KGV2ZW50LnRhcmdldC5kYXRhc2V0LmNhcnRRdWFudGl0eSk7XG4gICAgY29uc3QgaW5kZXggPSBldmVudC50YXJnZXQuZGF0YXNldC5pbmRleDtcbiAgICBjb25zdCBuYW1lID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKTtcblxuICAgIGNvbnN0IHF1YW50aXR5ID0gaW5wdXRWYWx1ZSAtIGNhcnRRdWFudGl0eTtcblxuICAgIGlmIChjYXJ0UXVhbnRpdHkgPiAwKSB7XG4gICAgICB0aGlzLnVwZGF0ZVF1YW50aXR5KGluZGV4LCBpbnB1dFZhbHVlLCBuYW1lLCB0aGlzLmFjdGlvbnMudXBkYXRlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51cGRhdGVRdWFudGl0eShpbmRleCwgcXVhbnRpdHksIG5hbWUsIHRoaXMuYWN0aW9ucy5hZGQpO1xuICAgIH1cbiAgfVxuXG4gIG9uQ2FydFVwZGF0ZSgpIHtcbiAgICBmZXRjaChgJHt3aW5kb3cubG9jYXRpb24ucGF0aG5hbWV9P3NlY3Rpb25faWQ9JHt0aGlzLnNlY3Rpb25JZH1gKVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS50ZXh0KCkpXG4gICAgICAudGhlbigocmVzcG9uc2VUZXh0KSA9PiB7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHJlc3BvbnNlVGV4dCwgJ3RleHQvaHRtbCcpO1xuICAgICAgICBjb25zdCBzb3VyY2VRdHkgPSBodG1sLnF1ZXJ5U2VsZWN0b3IodGhpcy5xdWlja09yZGVyTGlzdElkKTtcbiAgICAgICAgdGhpcy5pbm5lckhUTUwgPSBzb3VyY2VRdHkuaW5uZXJIVE1MO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgfSk7XG4gIH1cblxuICBnZXRTZWN0aW9uc1RvUmVuZGVyKCkge1xuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIGlkOiB0aGlzLnF1aWNrT3JkZXJMaXN0SWQsXG4gICAgICAgIHNlY3Rpb246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucXVpY2tPcmRlckxpc3RJZCkuZGF0YXNldC5pZCxcbiAgICAgICAgc2VsZWN0b3I6ICcuanMtY29udGVudHMnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdjYXJ0LWljb24tYnViYmxlJyxcbiAgICAgICAgc2VjdGlvbjogJ2NhcnQtaWNvbi1idWJibGUnLFxuICAgICAgICBzZWxlY3RvcjogJy5zaG9waWZ5LXNlY3Rpb24nLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdxdWljay1vcmRlci1saXN0LWxpdmUtcmVnaW9uLXRleHQnLFxuICAgICAgICBzZWN0aW9uOiAnY2FydC1saXZlLXJlZ2lvbi10ZXh0JyxcbiAgICAgICAgc2VsZWN0b3I6ICcuc2hvcGlmeS1zZWN0aW9uJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAncXVpY2stb3JkZXItbGlzdC10b3RhbCcsXG4gICAgICAgIHNlY3Rpb246IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucXVpY2tPcmRlckxpc3RJZCkuZGF0YXNldC5pZCxcbiAgICAgICAgc2VsZWN0b3I6ICcucXVpY2stb3JkZXItbGlzdF9fdG90YWwnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdDYXJ0RHJhd2VyJyxcbiAgICAgICAgc2VsZWN0b3I6ICcjQ2FydERyYXdlcicsXG4gICAgICAgIHNlY3Rpb246ICdjYXJ0LWRyYXdlcicsXG4gICAgICB9LFxuICAgIF07XG4gIH1cblxuICByZW5kZXJTZWN0aW9ucyhwYXJzZWRTdGF0ZSkge1xuICAgIHRoaXMuZ2V0U2VjdGlvbnNUb1JlbmRlcigpLmZvckVhY2goKHNlY3Rpb24pID0+IHtcbiAgICAgIGNvbnN0IHNlY3Rpb25FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VjdGlvbi5pZCk7XG4gICAgICBpZiAoc2VjdGlvbkVsZW1lbnQgJiYgc2VjdGlvbkVsZW1lbnQucGFyZW50RWxlbWVudCAmJiBzZWN0aW9uRWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZHJhd2VyJykpIHtcbiAgICAgICAgcGFyc2VkU3RhdGUuaXRlbXMubGVuZ3RoID4gMFxuICAgICAgICAgID8gc2VjdGlvbkVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1lbXB0eScpXG4gICAgICAgICAgOiBzZWN0aW9uRWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWVtcHR5Jyk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI0NhcnREcmF3ZXItT3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jYXJ0LmNsb3NlLmJpbmQodGhpcy5jYXJ0KSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgZWxlbWVudFRvUmVwbGFjZSA9XG4gICAgICAgIHNlY3Rpb25FbGVtZW50ICYmIHNlY3Rpb25FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VjdGlvbi5zZWxlY3RvcilcbiAgICAgICAgICA/IHNlY3Rpb25FbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VjdGlvbi5zZWxlY3RvcilcbiAgICAgICAgICA6IHNlY3Rpb25FbGVtZW50O1xuICAgICAgaWYgKGVsZW1lbnRUb1JlcGxhY2UpIHtcbiAgICAgICAgZWxlbWVudFRvUmVwbGFjZS5pbm5lckhUTUwgPSB0aGlzLmdldFNlY3Rpb25Jbm5lckhUTUwocGFyc2VkU3RhdGUuc2VjdGlvbnNbc2VjdGlvbi5zZWN0aW9uXSwgc2VjdGlvbi5zZWxlY3Rvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVNdWx0aXBsZVF0eShpdGVtcykge1xuICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnZhcmlhbnQtcmVtb3ZlLXRvdGFsIC5sb2FkaW5nX19zcGlubmVyJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cbiAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgdXBkYXRlczogaXRlbXMsXG4gICAgICBzZWN0aW9uczogdGhpcy5nZXRTZWN0aW9uc1RvUmVuZGVyKCkubWFwKChzZWN0aW9uKSA9PiBzZWN0aW9uLnNlY3Rpb24pLFxuICAgICAgc2VjdGlvbnNfdXJsOiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUsXG4gICAgfSk7XG5cbiAgICB0aGlzLnVwZGF0ZU1lc3NhZ2UoKTtcbiAgICB0aGlzLnNldEVycm9yTWVzc2FnZSgpO1xuXG4gICAgZmV0Y2goYCR7cm91dGVzLmNhcnRfdXBkYXRlX3VybH1gLCB7IC4uLmZldGNoQ29uZmlnKCksIC4uLnsgYm9keSB9IH0pXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigoc3RhdGUpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkU3RhdGUgPSBKU09OLnBhcnNlKHN0YXRlKTtcbiAgICAgICAgdGhpcy5yZW5kZXJTZWN0aW9ucyhwYXJzZWRTdGF0ZSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRFcnJvck1lc3NhZ2Uod2luZG93LmNhcnRTdHJpbmdzLmVycm9yKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnZhcmlhbnQtcmVtb3ZlLXRvdGFsIC5sb2FkaW5nX19zcGlubmVyJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZVF1YW50aXR5KGlkLCBxdWFudGl0eSwgbmFtZSwgYWN0aW9uKSB7XG4gICAgdGhpcy50b2dnbGVMb2FkaW5nKGlkLCB0cnVlKTtcblxuICAgIGxldCByb3V0ZVVybCA9IHJvdXRlcy5jYXJ0X2NoYW5nZV91cmw7XG4gICAgbGV0IGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBxdWFudGl0eSxcbiAgICAgIGlkLFxuICAgICAgc2VjdGlvbnM6IHRoaXMuZ2V0U2VjdGlvbnNUb1JlbmRlcigpLm1hcCgoc2VjdGlvbikgPT4gc2VjdGlvbi5zZWN0aW9uKSxcbiAgICAgIHNlY3Rpb25zX3VybDogd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLFxuICAgIH0pO1xuICAgIGxldCBmZXRjaENvbmZpZ1R5cGU7XG4gICAgaWYgKGFjdGlvbiA9PT0gdGhpcy5hY3Rpb25zLmFkZCkge1xuICAgICAgZmV0Y2hDb25maWdUeXBlID0gJ2phdmFzY3JpcHQnO1xuICAgICAgcm91dGVVcmwgPSByb3V0ZXMuY2FydF9hZGRfdXJsO1xuICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaXRlbXM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBxdWFudGl0eTogcGFyc2VJbnQocXVhbnRpdHkpLFxuICAgICAgICAgICAgaWQ6IHBhcnNlSW50KGlkKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBzZWN0aW9uczogdGhpcy5nZXRTZWN0aW9uc1RvUmVuZGVyKCkubWFwKChzZWN0aW9uKSA9PiBzZWN0aW9uLnNlY3Rpb24pLFxuICAgICAgICBzZWN0aW9uc191cmw6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlTWVzc2FnZSgpO1xuICAgIHRoaXMuc2V0RXJyb3JNZXNzYWdlKCk7XG5cbiAgICBmZXRjaChgJHtyb3V0ZVVybH1gLCB7IC4uLmZldGNoQ29uZmlnKGZldGNoQ29uZmlnVHlwZSksIC4uLnsgYm9keSB9IH0pXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigoc3RhdGUpID0+IHtcbiAgICAgICAgY29uc3QgcGFyc2VkU3RhdGUgPSBKU09OLnBhcnNlKHN0YXRlKTtcbiAgICAgICAgY29uc3QgcXVhbnRpdHlFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFF1YW50aXR5LSR7aWR9YCk7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnZhcmlhbnQtaXRlbScpO1xuXG4gICAgICAgIGlmIChwYXJzZWRTdGF0ZS5kZXNjcmlwdGlvbiB8fCBwYXJzZWRTdGF0ZS5lcnJvcnMpIHtcbiAgICAgICAgICBjb25zdCB2YXJpYW50SXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBgW2lkXj1cIlZhcmlhbnQtJHtpZH1cIl0gLnZhcmlhbnQtaXRlbV9fdG90YWxzLnNtYWxsLWhpZGUgLmxvYWRpbmdfX3NwaW5uZXJgXG4gICAgICAgICAgKTtcbiAgICAgICAgICB2YXJpYW50SXRlbS5jbGFzc0xpc3QuYWRkKCdsb2FkaW5nX19zcGlubmVyLS1lcnJvcicpO1xuICAgICAgICAgIHRoaXMucmVzZXRRdWFudGl0eUlucHV0KGlkLCBxdWFudGl0eUVsZW1lbnQpO1xuICAgICAgICAgIGlmIChwYXJzZWRTdGF0ZS5lcnJvcnMpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTGl2ZVJlZ2lvbnMoaWQsIHBhcnNlZFN0YXRlLmVycm9ycyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTGl2ZVJlZ2lvbnMoaWQsIHBhcnNlZFN0YXRlLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbGFzc0xpc3QudG9nZ2xlKCdpcy1lbXB0eScsIHBhcnNlZFN0YXRlLml0ZW1fY291bnQgPT09IDApO1xuXG4gICAgICAgIHRoaXMucmVuZGVyU2VjdGlvbnMocGFyc2VkU3RhdGUpO1xuXG4gICAgICAgIGxldCBoYXNFcnJvciA9IGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRJdGVtID0gcGFyc2VkU3RhdGUuaXRlbXMuZmluZCgoaXRlbSkgPT4gaXRlbS52YXJpYW50X2lkID09PSBwYXJzZUludChpZCkpO1xuICAgICAgICBjb25zdCB1cGRhdGVkVmFsdWUgPSBjdXJyZW50SXRlbSA/IGN1cnJlbnRJdGVtLnF1YW50aXR5IDogdW5kZWZpbmVkO1xuICAgICAgICBpZiAodXBkYXRlZFZhbHVlICYmIHVwZGF0ZWRWYWx1ZSAhPT0gcXVhbnRpdHkpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZUVycm9yKHVwZGF0ZWRWYWx1ZSwgaWQpO1xuICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhcmlhbnRJdGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYFZhcmlhbnQtJHtpZH1gKTtcbiAgICAgICAgaWYgKHZhcmlhbnRJdGVtICYmIHZhcmlhbnRJdGVtLnF1ZXJ5U2VsZWN0b3IoYFtuYW1lPVwiJHtuYW1lfVwiXWApKSB7XG4gICAgICAgICAgdmFyaWFudEl0ZW0ucXVlcnlTZWxlY3RvcihgW25hbWU9XCIke25hbWV9XCJdYCkuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgICBwdWJsaXNoKFBVQl9TVUJfRVZFTlRTLmNhcnRVcGRhdGUsIHsgc291cmNlOiB0aGlzLnF1aWNrT3JkZXJMaXN0SWQsIGNhcnREYXRhOiBwYXJzZWRTdGF0ZSB9KTtcblxuICAgICAgICBpZiAoaGFzRXJyb3IpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZU1lc3NhZ2UoKTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IHRoaXMuYWN0aW9ucy5hZGQpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZU1lc3NhZ2UocGFyc2VJbnQocXVhbnRpdHkpKTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IHRoaXMuYWN0aW9ucy51cGRhdGUpIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZU1lc3NhZ2UocGFyc2VJbnQocXVhbnRpdHkgLSBxdWFudGl0eUVsZW1lbnQuZGF0YXNldC5jYXJ0UXVhbnRpdHkpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZU1lc3NhZ2UoLXBhcnNlSW50KHF1YW50aXR5RWxlbWVudC5kYXRhc2V0LmNhcnRRdWFudGl0eSkpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5sb2FkaW5nX19zcGlubmVyJykuZm9yRWFjaCgob3ZlcmxheSkgPT4gb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKSk7XG4gICAgICAgIHRoaXMucmVzZXRRdWFudGl0eUlucHV0KGlkKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIHRoaXMuc2V0RXJyb3JNZXNzYWdlKHdpbmRvdy5jYXJ0U3RyaW5ncy5lcnJvcik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICB0aGlzLnRvZ2dsZUxvYWRpbmcoaWQpO1xuICAgICAgfSk7XG4gIH1cblxuICByZXNldFF1YW50aXR5SW5wdXQoaWQsIHF1YW50aXR5RWxlbWVudCkge1xuICAgIGNvbnN0IGlucHV0ID0gcXVhbnRpdHlFbGVtZW50ID8/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBRdWFudGl0eS0ke2lkfWApO1xuICAgIGlucHV0LnZhbHVlID0gaW5wdXQuZ2V0QXR0cmlidXRlKCd2YWx1ZScpO1xuICB9XG5cbiAgc2V0RXJyb3JNZXNzYWdlKG1lc3NhZ2UgPSBudWxsKSB7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2VUZW1wbGF0ZSA9XG4gICAgICB0aGlzLmVycm9yTWVzc2FnZVRlbXBsYXRlID8/XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgUXVpY2tPcmRlckxpc3RFcnJvclRlbXBsYXRlLSR7dGhpcy5zZWN0aW9uSWR9YCkuY2xvbmVOb2RlKHRydWUpO1xuICAgIGNvbnN0IGVycm9yRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucXVpY2stb3JkZXItbGlzdC1lcnJvcicpO1xuXG4gICAgZXJyb3JFbGVtZW50cy5mb3JFYWNoKChlcnJvckVsZW1lbnQpID0+IHtcbiAgICAgIGVycm9yRWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgIGlmICghbWVzc2FnZSkgcmV0dXJuO1xuICAgICAgY29uc3QgdXBkYXRlZE1lc3NhZ2VFbGVtZW50ID0gdGhpcy5lcnJvck1lc3NhZ2VUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICB1cGRhdGVkTWVzc2FnZUVsZW1lbnQuY29udGVudC5xdWVyeVNlbGVjdG9yKCcucXVpY2stb3JkZXItbGlzdC1lcnJvci1tZXNzYWdlJykuaW5uZXJUZXh0ID0gbWVzc2FnZTtcbiAgICAgIGVycm9yRWxlbWVudC5hcHBlbmRDaGlsZCh1cGRhdGVkTWVzc2FnZUVsZW1lbnQuY29udGVudCk7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVNZXNzYWdlKHF1YW50aXR5ID0gbnVsbCkge1xuICAgIGNvbnN0IG1lc3NhZ2VzID0gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKCcucXVpY2stb3JkZXItbGlzdF9fbWVzc2FnZS10ZXh0Jyk7XG4gICAgY29uc3QgaWNvbnMgPSB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoJy5xdWljay1vcmRlci1saXN0X19tZXNzYWdlLWljb24nKTtcblxuICAgIGlmIChxdWFudGl0eSA9PT0gbnVsbCB8fCBpc05hTihxdWFudGl0eSkpIHtcbiAgICAgIG1lc3NhZ2VzLmZvckVhY2goKG1lc3NhZ2UpID0+IChtZXNzYWdlLmlubmVySFRNTCA9ICcnKSk7XG4gICAgICBpY29ucy5mb3JFYWNoKChpY29uKSA9PiBpY29uLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpc1F1YW50aXR5TmVnYXRpdmUgPSBxdWFudGl0eSA8IDA7XG4gICAgY29uc3QgYWJzUXVhbnRpdHkgPSBNYXRoLmFicyhxdWFudGl0eSk7XG5cbiAgICBjb25zdCB0ZXh0VGVtcGxhdGUgPSBpc1F1YW50aXR5TmVnYXRpdmVcbiAgICAgID8gYWJzUXVhbnRpdHkgPT09IDFcbiAgICAgICAgPyB3aW5kb3cucXVpY2tPcmRlckxpc3RTdHJpbmdzLml0ZW1SZW1vdmVkXG4gICAgICAgIDogd2luZG93LnF1aWNrT3JkZXJMaXN0U3RyaW5ncy5pdGVtc1JlbW92ZWRcbiAgICAgIDogcXVhbnRpdHkgPT09IDFcbiAgICAgID8gd2luZG93LnF1aWNrT3JkZXJMaXN0U3RyaW5ncy5pdGVtQWRkZWRcbiAgICAgIDogd2luZG93LnF1aWNrT3JkZXJMaXN0U3RyaW5ncy5pdGVtc0FkZGVkO1xuXG4gICAgbWVzc2FnZXMuZm9yRWFjaCgobXNnKSA9PiAobXNnLmlubmVySFRNTCA9IHRleHRUZW1wbGF0ZS5yZXBsYWNlKCdbcXVhbnRpdHldJywgYWJzUXVhbnRpdHkpKSk7XG5cbiAgICBpZiAoIWlzUXVhbnRpdHlOZWdhdGl2ZSkge1xuICAgICAgaWNvbnMuZm9yRWFjaCgoaSkgPT4gaS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKSk7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlRXJyb3IodXBkYXRlZFZhbHVlLCBpZCkge1xuICAgIGxldCBtZXNzYWdlID0gJyc7XG4gICAgaWYgKHR5cGVvZiB1cGRhdGVkVmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBtZXNzYWdlID0gd2luZG93LmNhcnRTdHJpbmdzLmVycm9yO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZXNzYWdlID0gd2luZG93LmNhcnRTdHJpbmdzLnF1YW50aXR5RXJyb3IucmVwbGFjZSgnW3F1YW50aXR5XScsIHVwZGF0ZWRWYWx1ZSk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlTGl2ZVJlZ2lvbnMoaWQsIG1lc3NhZ2UpO1xuICB9XG5cbiAgdXBkYXRlTGl2ZVJlZ2lvbnMoaWQsIG1lc3NhZ2UpIHtcbiAgICBjb25zdCB2YXJpYW50SXRlbUVycm9yRGVza3RvcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBRdWljay1vcmRlci1saXN0LWl0ZW0tZXJyb3ItZGVza3RvcC0ke2lkfWApO1xuICAgIGNvbnN0IHZhcmlhbnRJdGVtRXJyb3JNb2JpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgUXVpY2stb3JkZXItbGlzdC1pdGVtLWVycm9yLW1vYmlsZS0ke2lkfWApO1xuICAgIGlmICh2YXJpYW50SXRlbUVycm9yRGVza3RvcCkge1xuICAgICAgdmFyaWFudEl0ZW1FcnJvckRlc2t0b3AucXVlcnlTZWxlY3RvcignLnZhcmlhbnQtaXRlbV9fZXJyb3ItdGV4dCcpLmlubmVySFRNTCA9IG1lc3NhZ2U7XG4gICAgICB2YXJpYW50SXRlbUVycm9yRGVza3RvcC5jbG9zZXN0KCd0cicpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIH1cbiAgICBpZiAodmFyaWFudEl0ZW1FcnJvck1vYmlsZSkgdmFyaWFudEl0ZW1FcnJvck1vYmlsZS5xdWVyeVNlbGVjdG9yKCcudmFyaWFudC1pdGVtX19lcnJvci10ZXh0JykuaW5uZXJIVE1MID0gbWVzc2FnZTtcblxuICAgIHRoaXMudmFyaWFudEl0ZW1TdGF0dXNFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcblxuICAgIGNvbnN0IGNhcnRTdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVpY2stb3JkZXItbGlzdC1saXZlLXJlZ2lvbi10ZXh0Jyk7XG4gICAgY2FydFN0YXR1cy5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgZmFsc2UpO1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjYXJ0U3RhdHVzLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIGdldFNlY3Rpb25Jbm5lckhUTUwoaHRtbCwgc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sLCAndGV4dC9odG1sJykucXVlcnlTZWxlY3RvcihzZWxlY3RvcikuaW5uZXJIVE1MO1xuICB9XG5cbiAgdG9nZ2xlTG9hZGluZyhpZCwgZW5hYmxlKSB7XG4gICAgY29uc3QgcXVpY2tPcmRlckxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnF1aWNrT3JkZXJMaXN0SWQpO1xuICAgIGNvbnN0IHF1aWNrT3JkZXJMaXN0SXRlbXMgPSB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoYCNWYXJpYW50LSR7aWR9IC5sb2FkaW5nX19zcGlubmVyYCk7XG5cbiAgICBpZiAoZW5hYmxlKSB7XG4gICAgICBxdWlja09yZGVyTGlzdC5jbGFzc0xpc3QuYWRkKCdxdWljay1vcmRlci1saXN0X19jb250YWluZXItLWRpc2FibGVkJyk7XG4gICAgICBbLi4ucXVpY2tPcmRlckxpc3RJdGVtc10uZm9yRWFjaCgob3ZlcmxheSkgPT4gb3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKSk7XG4gICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICAgIHRoaXMudmFyaWFudEl0ZW1TdGF0dXNFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCBmYWxzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHF1aWNrT3JkZXJMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3F1aWNrLW9yZGVyLWxpc3RfX2NvbnRhaW5lci0tZGlzYWJsZWQnKTtcbiAgICAgIHF1aWNrT3JkZXJMaXN0SXRlbXMuZm9yRWFjaCgob3ZlcmxheSkgPT4gb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKSk7XG4gICAgfVxuICB9XG59XG5cbmN1c3RvbUVsZW1lbnRzLmRlZmluZSgncXVpY2stb3JkZXItbGlzdCcsIFF1aWNrT3JkZXJMaXN0KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/js/components/quick-order-list.js\n"
        );

        /***/
      },

    /******/
  };
  /************************************************************************/
  /******/
  /******/ // startup
  /******/ // Load entry module and return exports
  /******/ // This entry module can't be inlined because the eval-source-map devtool is used.
  /******/ var __webpack_exports__ = {};
  /******/ __webpack_modules__["./src/js/components/quick-order-list.js"]();
  /******/
  /******/
})();
